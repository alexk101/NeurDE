# @package _global_
# Main configuration file for NeurDE training
# Use Hydra to override: python train_stage1.py case=cylinder stage=1

defaults:
  - _self_
  - case: cylinder
  - model: neurde
  - training: stage1
  - optimizer: adamw
  - scheduler: cosineannealing
  - dataset: stage1

# Training stage (1 or 2)
stage: 1

# Device configuration
device: 0  # GPU index, or -1 for CPU

# Model compilation
compile: true

# Model saving
save_model: true
save_frequency: 1  # Minimum epochs between best model saves

# Checkpointing (full checkpoints with optimizer/scheduler state)
checkpoint_frequency: 0  # Save full checkpoint every N epochs (0 = disabled)
keep_checkpoints: 5  # Number of periodic checkpoints to keep (old ones are deleted)

# Resume training
resume_from: null  # Path to checkpoint to resume from (full checkpoint format)

# Pretrained model (for Stage 2)
pretrained_path: null  # Path to pretrained Stage 1 model checkpoint (state_dict only)

run_name: 'default' # name to use for experiment dir + slurm job + wandb
run_tag: '00' # tag to identify a particular run

# Data configuration
num_samples: 500
batch_size: 32

# Data generation (for generate_data.py)
steps: 1000  # Number of simulation steps to generate
transfer_batch_size: 100  # Number of steps to accumulate on GPU before transferring to CPU (higher = better GPU utilization, more GPU memory)
